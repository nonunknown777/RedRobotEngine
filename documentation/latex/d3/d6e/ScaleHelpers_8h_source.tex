\doxysection{Scale\+Helpers.\+h}
\hypertarget{ScaleHelpers_8h_source}{}\label{ScaleHelpers_8h_source}\index{includes/jolt/Physics/Collision/Shape/ScaleHelpers.h@{includes/jolt/Physics/Collision/Shape/ScaleHelpers.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Jolt\ Physics\ Library\ (https://github.com/jrouwe/JoltPhysics)}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ SPDX-\/FileCopyrightText:\ 2021\ Jorrit\ Rouwe}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ SPDX-\/License-\/Identifier:\ MIT}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <Jolt/Physics/PhysicsSettings.h>}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ JPH\_NAMESPACE\_BEGIN}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00012\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespaceScaleHelpers}{ScaleHelpers}}}
\DoxyCodeLine{00013\ \{}
\DoxyCodeLine{00015\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{float}\ \ cScaleToleranceSq\ =\ 1.0e-\/8f;}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00018\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceScaleHelpers_abf3b185a98bea874b96fa82a0db2d7e2}{IsNotScaled}}(\mbox{\hyperlink{classVec3}{Vec3Arg}}\ inScale)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ inScale.\mbox{\hyperlink{classVec3_a0b134a58f09912cb5cac913313487fad}{IsClose}}(\mbox{\hyperlink{classVec3_ad6be51ce14811d6c196784d20cb39b98}{Vec3::sReplicate}}(1.0f),\ cScaleToleranceSq);\ \}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00021\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceScaleHelpers_a8ff2f9310527acbb4b02a00150fe02fe}{IsUniformScale}}(\mbox{\hyperlink{classVec3}{Vec3Arg}}\ inScale)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ inScale.\mbox{\hyperlink{classVec3_afd477997c0834bd3080156e730ced38d}{Swizzle}}<SWIZZLE\_Y,\ SWIZZLE\_Z,\ SWIZZLE\_X>().IsClose(inScale,\ cScaleToleranceSq);\ \}}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{float}\ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceScaleHelpers_a3c182e760f2d4a5b0985b20d50b0c870}{ScaleConvexRadius}}(\textcolor{keywordtype}{float}\ inConvexRadius,\ \mbox{\hyperlink{classVec3}{Vec3Arg}}\ inScale)\ \ \ \ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ min(inConvexRadius\ *\ inScale.\mbox{\hyperlink{classVec3_a60c863c1cdad322a1af54e77a4af8f02}{Abs}}().\mbox{\hyperlink{classVec3_a3b5c2f1c893d46d390428ef8c487cc7d}{ReduceMin}}(),\ cDefaultConvexRadius);\ \}}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceScaleHelpers_a968d814e04071d431f79a2ba4e9d4da1}{IsInsideOut}}(\mbox{\hyperlink{classVec3}{Vec3Arg}}\ inScale)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ (CountBits(\mbox{\hyperlink{classVec3_ad376453f8dddd6653c2ead9c02951c48}{Vec3::sLess}}(inScale,\ \mbox{\hyperlink{classVec3_ad03c52ab27761bc1e64e33c47632ba51}{Vec3::sZero}}()).GetTrues()\ \&\ 0x7)\ \&\ 1)\ !=\ 0;\ \}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classVec3}{Vec3}}\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceScaleHelpers_a1eeb857fb92f13a5ddd9dac662146b96}{MakeUniformScale}}(\mbox{\hyperlink{classVec3}{Vec3Arg}}\ inScale)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classVec3_ad6be51ce14811d6c196784d20cb39b98}{Vec3::sReplicate}}((inScale.\mbox{\hyperlink{classVec3_a284e29f161ae7709a934f402bd2a848c}{GetX}}()\ +\ inScale.GetY()\ +\ inScale.GetZ())\ /\ 3.0f);\ \}}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceScaleHelpers_a024fa9a3c672218ce6b7aaa97d953ae1}{CanScaleBeRotated}}(\mbox{\hyperlink{classQuat}{QuatArg}}\ inRotation,\ \mbox{\hyperlink{classVec3}{Vec3Arg}}\ inScale)}
\DoxyCodeLine{00037\ \ \ \ \ \{}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ inScale\ is\ a\ scale\ in\ local\ space\ of\ the\ shape,\ so\ the\ transform\ for\ the\ shape\ (ignoring\ translation)\ is:\ T\ =\ Mat44::sScale(inScale)\ *\ mRotation.}}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ when\ we\ pass\ the\ scale\ to\ the\ child\ it\ needs\ to\ be\ local\ to\ the\ child,\ so\ we\ want\ T\ =\ mRotation\ *\ Mat44::sScale(ChildScale).}}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Solving\ for\ ChildScale:\ ChildScale\ =\ mRotation\string^-\/1\ *\ Mat44::sScale(inScale)\ *\ mRotation\ =\ mRotation\string^T\ *\ Mat44::sScale(inScale)\ *\ mRotation}}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ any\ of\ the\ off\ diagonal\ elements\ are\ non-\/zero,\ it\ means\ the\ scale\ /\ rotation\ is\ not\ compatible.}}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMat44}{Mat44}}\ r\ =\ \mbox{\hyperlink{classMat44_ac3109f2d950061c0b4de57e76a132634}{Mat44::sRotation}}(inRotation);}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMat44}{Mat44}}\ child\_scale\ =\ r.\mbox{\hyperlink{classMat44_a1c302e1f10c6c5a233aed4a540e0f598}{Multiply3x3LeftTransposed}}(r.\mbox{\hyperlink{classMat44_a6503ccd1384b6681d191c327961fbb6d}{PostScaled}}(inScale));}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ columns,\ but\ zero\ the\ diagonal}}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classVec4}{Vec4}}\ zero\ =\ \mbox{\hyperlink{classVec4_ab3d9624594386baa4ebd8c1d340ce924}{Vec4::sZero}}();}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classVec4}{Vec4}}\ c0\ =\ \mbox{\hyperlink{classVec4_a6ae67a60e24b50c1b59050ef3d171228}{Vec4::sSelect}}(child\_scale.GetColumn4(0),\ zero,\ \mbox{\hyperlink{classUVec4}{UVec4}}(0xffffffff,\ 0,\ 0,\ 0)).\mbox{\hyperlink{classVec4_a321bcfc691705ad313b11822c8b13332}{Abs}}();}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classVec4}{Vec4}}\ c1\ =\ \mbox{\hyperlink{classVec4_a6ae67a60e24b50c1b59050ef3d171228}{Vec4::sSelect}}(child\_scale.GetColumn4(1),\ zero,\ \mbox{\hyperlink{classUVec4}{UVec4}}(0,\ 0xffffffff,\ 0,\ 0)).\mbox{\hyperlink{classVec4_a321bcfc691705ad313b11822c8b13332}{Abs}}();}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classVec4}{Vec4}}\ c2\ =\ \mbox{\hyperlink{classVec4_a6ae67a60e24b50c1b59050ef3d171228}{Vec4::sSelect}}(child\_scale.GetColumn4(2),\ zero,\ \mbox{\hyperlink{classUVec4}{UVec4}}(0,\ 0,\ 0xffffffff,\ 0)).\mbox{\hyperlink{classVec4_a321bcfc691705ad313b11822c8b13332}{Abs}}();}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Check\ if\ all\ elements\ are\ less\ than\ epsilon}}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classVec4}{Vec4}}\ epsilon\ =\ \mbox{\hyperlink{classVec4_af18f350dd2885dc48ff7e7cbf4b8bc9d}{Vec4::sReplicate}}(1.0e-\/6f);}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{classUVec4_a69a2126a24a31ead596e3316c1285145}{UVec4::sAnd}}(\mbox{\hyperlink{classUVec4_a69a2126a24a31ead596e3316c1285145}{UVec4::sAnd}}(\mbox{\hyperlink{classVec4_a4c8600bd26d971542437d4f31258dea4}{Vec4::sLess}}(c0,\ epsilon),\ \mbox{\hyperlink{classVec4_a4c8600bd26d971542437d4f31258dea4}{Vec4::sLess}}(c1,\ epsilon)),\ \mbox{\hyperlink{classVec4_a4c8600bd26d971542437d4f31258dea4}{Vec4::sLess}}(c2,\ epsilon)).\mbox{\hyperlink{classUVec4_a48549afaeaba00fc4b45a10c50656c9f}{TestAllTrue}}();}
\DoxyCodeLine{00054\ \ \ \ \ \}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keyword}{inline}\ \mbox{\hyperlink{classVec3}{Vec3}}\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespaceScaleHelpers_a317905196055a0a720d6468cbb4840b9}{RotateScale}}(\mbox{\hyperlink{classQuat}{QuatArg}}\ inRotation,\ \mbox{\hyperlink{classVec3}{Vec3Arg}}\ inScale)}
\DoxyCodeLine{00061\ \ \ \ \ \{}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Get\ the\ diagonal\ of\ mRotation\string^T\ *\ Mat44::sScale(inScale)\ *\ mRotation\ (see\ comment\ at\ CanScaleBeRotated)}}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classMat44}{Mat44}}\ r\ =\ \mbox{\hyperlink{classMat44_ac3109f2d950061c0b4de57e76a132634}{Mat44::sRotation}}(inRotation);}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ r.\mbox{\hyperlink{classMat44_a1c302e1f10c6c5a233aed4a540e0f598}{Multiply3x3LeftTransposed}}(r.\mbox{\hyperlink{classMat44_a6503ccd1384b6681d191c327961fbb6d}{PostScaled}}(inScale)).GetDiagonal3();}
\DoxyCodeLine{00065\ \ \ \ \ \}}
\DoxyCodeLine{00066\ \}}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ JPH\_NAMESPACE\_END}

\end{DoxyCode}
