\doxysection{Skeleton\+Mapper Class Reference}
\hypertarget{classSkeletonMapper}{}\label{classSkeletonMapper}\index{SkeletonMapper@{SkeletonMapper}}


Class that is able to map a low detail (ragdoll) skeleton to a high detail (animation) skeleton and vice versa.  




{\ttfamily \#include $<$Skeleton\+Mapper.\+h$>$}



Inheritance diagram for Skeleton\+Mapper\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{d4/df9/classSkeletonMapper__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for Skeleton\+Mapper\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{d9/d48/classSkeletonMapper__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classSkeletonMapper_1_1Chain}{Chain}}
\begin{DoxyCompactList}\small\item\em A joint chain that starts with a 1-\/on-\/1 mapped joint and ends with a 1-\/on-\/1 mapped joint with intermediate joints that cannot be mapped. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{classSkeletonMapper_1_1Locked}{Locked}}
\begin{DoxyCompactList}\small\item\em Joints that should have their translation locked (fixed) \end{DoxyCompactList}\item 
class \mbox{\hyperlink{classSkeletonMapper_1_1Mapping}{Mapping}}
\begin{DoxyCompactList}\small\item\em A joint that maps 1-\/on-\/1 to a joint in the other skeleton. \end{DoxyCompactList}\item 
class \mbox{\hyperlink{classSkeletonMapper_1_1Unmapped}{Unmapped}}
\begin{DoxyCompactList}\small\item\em Joints that could not be mapped from skeleton 1 to 2. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{classSkeletonMapper_a6d56bcd1cbaecd9f2b9013e6e04b7bf8}\label{classSkeletonMapper_a6d56bcd1cbaecd9f2b9013e6e04b7bf8} 
using {\bfseries Can\+Map\+Joint} = function$<$ bool(const \mbox{\hyperlink{classSkeleton}{Skeleton}} \texorpdfstring{$\ast$}{*}, int, const \mbox{\hyperlink{classSkeleton}{Skeleton}} \texorpdfstring{$\ast$}{*}, int)$>$
\begin{DoxyCompactList}\small\item\em A function that is called to determine if a joint can be mapped from source to target skeleton. \end{DoxyCompactList}\item 
\Hypertarget{classSkeletonMapper_a6f36fb9bc8686b8ec810c5435c03f419}\label{classSkeletonMapper_a6f36fb9bc8686b8ec810c5435c03f419} 
using {\bfseries Mapping\+Vector} = Array$<$ \mbox{\hyperlink{classSkeletonMapper_1_1Mapping}{Mapping}} $>$
\item 
\Hypertarget{classSkeletonMapper_a33aaf112a5908982c45a27b4c80155ea}\label{classSkeletonMapper_a33aaf112a5908982c45a27b4c80155ea} 
using {\bfseries Chain\+Vector} = Array$<$ \mbox{\hyperlink{classSkeletonMapper_1_1Chain}{Chain}} $>$
\item 
\Hypertarget{classSkeletonMapper_ae6baa7f85525bc34f52e77ac6cd2bbeb}\label{classSkeletonMapper_ae6baa7f85525bc34f52e77ac6cd2bbeb} 
using {\bfseries Unmapped\+Vector} = Array$<$ \mbox{\hyperlink{classSkeletonMapper_1_1Unmapped}{Unmapped}} $>$
\item 
\Hypertarget{classSkeletonMapper_a82c3843686fa3822fd9a5747be2a4b93}\label{classSkeletonMapper_a82c3843686fa3822fd9a5747be2a4b93} 
using {\bfseries Locked\+Vector} = Array$<$ \mbox{\hyperlink{classSkeletonMapper_1_1Locked}{Locked}} $>$
\end{DoxyCompactItemize}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{classSkeletonMapper_a63ce08263311941b64c074716b24c9bf}{Initialize}} (const \mbox{\hyperlink{classSkeleton}{Skeleton}} \texorpdfstring{$\ast$}{*}in\+Skeleton1, const \mbox{\hyperlink{classMat44}{Mat44}} \texorpdfstring{$\ast$}{*}in\+Neutral\+Pose1, const \mbox{\hyperlink{classSkeleton}{Skeleton}} \texorpdfstring{$\ast$}{*}in\+Skeleton2, const \mbox{\hyperlink{classMat44}{Mat44}} \texorpdfstring{$\ast$}{*}in\+Neutral\+Pose2, const \mbox{\hyperlink{classSkeletonMapper_a6d56bcd1cbaecd9f2b9013e6e04b7bf8}{Can\+Map\+Joint}} \&in\+Can\+Map\+Joint=\mbox{\hyperlink{classSkeletonMapper_a642ec444197fca150bddcadd5cb85bd5}{s\+Default\+Can\+Map\+Joint}})
\item 
void \mbox{\hyperlink{classSkeletonMapper_a2741193b04cb2cbe14996962fbf71b97}{Lock\+Translations}} (const \mbox{\hyperlink{classSkeleton}{Skeleton}} \texorpdfstring{$\ast$}{*}in\+Skeleton2, const bool \texorpdfstring{$\ast$}{*}in\+Locked\+Translations, const \mbox{\hyperlink{classMat44}{Mat44}} \texorpdfstring{$\ast$}{*}in\+Neutral\+Pose2)
\item 
void \mbox{\hyperlink{classSkeletonMapper_abbaa0b7c3a89c8332342c2cc6aa74262}{Lock\+All\+Translations}} (const \mbox{\hyperlink{classSkeleton}{Skeleton}} \texorpdfstring{$\ast$}{*}in\+Skeleton2, const \mbox{\hyperlink{classMat44}{Mat44}} \texorpdfstring{$\ast$}{*}in\+Neutral\+Pose2)
\item 
void \mbox{\hyperlink{classSkeletonMapper_aa5ea82586d40fbdc0d2930e51b008c9c}{Map}} (const \mbox{\hyperlink{classMat44}{Mat44}} \texorpdfstring{$\ast$}{*}in\+Pose1\+Model\+Space, const \mbox{\hyperlink{classMat44}{Mat44}} \texorpdfstring{$\ast$}{*}in\+Pose2\+Local\+Space, \mbox{\hyperlink{classMat44}{Mat44}} \texorpdfstring{$\ast$}{*}out\+Pose2\+Model\+Space) const
\item 
void \mbox{\hyperlink{classSkeletonMapper_a64ebec9cb8e8f0f7a4ec68fa0c30bfd6}{Map\+Reverse}} (const \mbox{\hyperlink{classMat44}{Mat44}} \texorpdfstring{$\ast$}{*}in\+Pose2\+Model\+Space, \mbox{\hyperlink{classMat44}{Mat44}} \texorpdfstring{$\ast$}{*}out\+Pose1\+Model\+Space) const
\item 
\Hypertarget{classSkeletonMapper_a21b16b76b464cf207878aa382c6cfde4}\label{classSkeletonMapper_a21b16b76b464cf207878aa382c6cfde4} 
int {\bfseries Get\+Mapped\+Joint\+Idx} (int in\+Joint1\+Idx) const
\begin{DoxyCompactList}\small\item\em Search through the directly mapped joints (m\+Mappings) and find in\+Joint1\+Idx, returns the corresponding Joint2\+Idx or -\/1 if not found. \end{DoxyCompactList}\item 
\Hypertarget{classSkeletonMapper_a6fcd34ef9c18a53f65679b5d671e6147}\label{classSkeletonMapper_a6fcd34ef9c18a53f65679b5d671e6147} 
bool {\bfseries Is\+Joint\+Translation\+Locked} (int in\+Joint2\+Idx) const
\begin{DoxyCompactList}\small\item\em Search through the locked translations (m\+Locked\+Translations) and find if joint in\+Joint2\+Idx is locked. \end{DoxyCompactList}\end{DoxyCompactItemize}
\begin{Indent}\textbf{ Access to the mapped joints}\par
\begin{DoxyCompactItemize}
\item 
\Hypertarget{classSkeletonMapper_a13fa458d09dbb5f053aff54bb009d0eb}\label{classSkeletonMapper_a13fa458d09dbb5f053aff54bb009d0eb} 
const Mapping\+Vector \& {\bfseries Get\+Mappings} () const
\item 
\Hypertarget{classSkeletonMapper_a120855b77dff525cd820068b115e101f}\label{classSkeletonMapper_a120855b77dff525cd820068b115e101f} 
Mapping\+Vector \& {\bfseries Get\+Mappings} ()
\item 
\Hypertarget{classSkeletonMapper_ad60ebc6d5ff4c2d1402199c56f698c4a}\label{classSkeletonMapper_ad60ebc6d5ff4c2d1402199c56f698c4a} 
const Chain\+Vector \& {\bfseries Get\+Chains} () const
\item 
\Hypertarget{classSkeletonMapper_a5438aa5e4ec00c89a000a12db4d4c8d4}\label{classSkeletonMapper_a5438aa5e4ec00c89a000a12db4d4c8d4} 
Chain\+Vector \& {\bfseries Get\+Chains} ()
\item 
\Hypertarget{classSkeletonMapper_a4b67e8a430be5b9150676f5103ef0974}\label{classSkeletonMapper_a4b67e8a430be5b9150676f5103ef0974} 
const Unmapped\+Vector \& {\bfseries Get\+Unmapped} () const
\item 
\Hypertarget{classSkeletonMapper_ae5c8deb7c2eebbfd0f2088c33f991ec8}\label{classSkeletonMapper_ae5c8deb7c2eebbfd0f2088c33f991ec8} 
Unmapped\+Vector \& {\bfseries Get\+Unmapped} ()
\item 
\Hypertarget{classSkeletonMapper_ae866ae2bc8b6461888f555b6a9be0d16}\label{classSkeletonMapper_ae866ae2bc8b6461888f555b6a9be0d16} 
const Locked\+Vector \& {\bfseries Get\+Locked\+Translations} () const
\item 
\Hypertarget{classSkeletonMapper_a9e9a4605520a2d38d190e0f651b3b6c2}\label{classSkeletonMapper_a9e9a4605520a2d38d190e0f651b3b6c2} 
Locked\+Vector \& {\bfseries Get\+Locked\+Translations} ()
\end{DoxyCompactItemize}
\end{Indent}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classRefTarget}{Ref\+Target$<$ Skeleton\+Mapper $>$}}}
\begin{DoxyCompactItemize}
\item 
{\bfseries Ref\+Target} ()=default
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
{\bfseries Ref\+Target} (const \mbox{\hyperlink{classRefTarget}{Ref\+Target}} \&)
\item 
{\bfseries \texorpdfstring{$\sim$}{\string~}\+Ref\+Target} ()
\begin{DoxyCompactList}\small\item\em assert no one is referencing us \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classRefTarget_a3befa746ea517453572f6f4f5fc3b099}{Set\+Embedded}} () const
\item 
\mbox{\hyperlink{classRefTarget}{Ref\+Target}} \& {\bfseries operator=} (const \mbox{\hyperlink{classRefTarget}{Ref\+Target}} \&)
\begin{DoxyCompactList}\small\item\em Assignment operator. \end{DoxyCompactList}\item 
uint32 {\bfseries Get\+Ref\+Count} () const
\begin{DoxyCompactList}\small\item\em Get current refcount of this object. \end{DoxyCompactList}\item 
void {\bfseries Add\+Ref} () const
\begin{DoxyCompactList}\small\item\em Add or release a reference to this object. \end{DoxyCompactList}\item 
void {\bfseries Release} () const
\end{DoxyCompactItemize}
\doxysubsubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{classSkeletonMapper_a642ec444197fca150bddcadd5cb85bd5}\label{classSkeletonMapper_a642ec444197fca150bddcadd5cb85bd5} 
static bool {\bfseries s\+Default\+Can\+Map\+Joint} (const \mbox{\hyperlink{classSkeleton}{Skeleton}} \texorpdfstring{$\ast$}{*}in\+Skeleton1, int in\+Index1, const \mbox{\hyperlink{classSkeleton}{Skeleton}} \texorpdfstring{$\ast$}{*}in\+Skeleton2, int in\+Index2)
\begin{DoxyCompactList}\small\item\em Default function that checks if the names of the joints are equal. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions inherited from \mbox{\hyperlink{classRefTarget}{Ref\+Target$<$ Skeleton\+Mapper $>$}}}
\begin{DoxyCompactItemize}
\item 
static int {\bfseries s\+Internal\+Get\+Ref\+Count\+Offset} ()
\begin{DoxyCompactList}\small\item\em INTERNAL HELPER FUNCTION USED BY SERIALIZATION. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Additional Inherited Members}
\doxysubsection*{Protected Attributes inherited from \mbox{\hyperlink{classRefTarget}{Ref\+Target$<$ Skeleton\+Mapper $>$}}}
\begin{DoxyCompactItemize}
\item 
atomic$<$ uint32 $>$ {\bfseries m\+Ref\+Count}
\begin{DoxyCompactList}\small\item\em Current reference count. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Static Protected Attributes inherited from \mbox{\hyperlink{classRefTarget}{Ref\+Target$<$ Skeleton\+Mapper $>$}}}
\begin{DoxyCompactItemize}
\item 
static constexpr uint32 {\bfseries c\+Embedded}
\begin{DoxyCompactList}\small\item\em A large value that gets added to the refcount to mark the object as embedded. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Class that is able to map a low detail (ragdoll) skeleton to a high detail (animation) skeleton and vice versa. 

\doxysubsection{Member Function Documentation}
\Hypertarget{classSkeletonMapper_a63ce08263311941b64c074716b24c9bf}\label{classSkeletonMapper_a63ce08263311941b64c074716b24c9bf} 
\index{SkeletonMapper@{SkeletonMapper}!Initialize@{Initialize}}
\index{Initialize@{Initialize}!SkeletonMapper@{SkeletonMapper}}
\doxysubsubsection{\texorpdfstring{Initialize()}{Initialize()}}
{\footnotesize\ttfamily void Skeleton\+Mapper\+::\+Initialize (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classSkeleton}{Skeleton}} \texorpdfstring{$\ast$}{*}}]{in\+Skeleton1,  }\item[{const \mbox{\hyperlink{classMat44}{Mat44}} \texorpdfstring{$\ast$}{*}}]{in\+Neutral\+Pose1,  }\item[{const \mbox{\hyperlink{classSkeleton}{Skeleton}} \texorpdfstring{$\ast$}{*}}]{in\+Skeleton2,  }\item[{const \mbox{\hyperlink{classMat44}{Mat44}} \texorpdfstring{$\ast$}{*}}]{in\+Neutral\+Pose2,  }\item[{const \mbox{\hyperlink{classSkeletonMapper_a6d56bcd1cbaecd9f2b9013e6e04b7bf8}{Can\+Map\+Joint}} \&}]{in\+Can\+Map\+Joint = {\ttfamily \mbox{\hyperlink{classSkeletonMapper_a642ec444197fca150bddcadd5cb85bd5}{s\+Default\+Can\+Map\+Joint}}} }\end{DoxyParamCaption})}

Initialize the skeleton mapper. \doxylink{classSkeleton}{Skeleton} 1 should be the (low detail) ragdoll skeleton and skeleton 2 the (high detail) animation skeleton. We assume that each joint in skeleton 1 can be mapped to a joint in skeleton 2 (if not mapping from animation skeleton to ragdoll skeleton will be undefined). \doxylink{classSkeleton}{Skeleton} 2 should have the same hierarchy as skeleton 1 but can contain extra joints between those in skeleton 1 and it can have extra joints at the root and leaves of the skeleton. 
\begin{DoxyParams}{Parameters}
{\em in\+Skeleton1} & Source skeleton to map from. \\
\hline
{\em in\+Neutral\+Pose1} & Neutral pose of the source skeleton (model space) \\
\hline
{\em in\+Skeleton2} & Target skeleton to map to. \\
\hline
{\em in\+Neutral\+Pose2} & Neutral pose of the target skeleton (model space), in\+Neutral\+Pose1 and in\+Neutral\+Pose2 must match as closely as possible, preferably the position of the mappable joints should be identical. \\
\hline
{\em in\+Can\+Map\+Joint} & Function that checks if joints in skeleton 1 and skeleton 2 are equal. \\
\hline
\end{DoxyParams}
\Hypertarget{classSkeletonMapper_abbaa0b7c3a89c8332342c2cc6aa74262}\label{classSkeletonMapper_abbaa0b7c3a89c8332342c2cc6aa74262} 
\index{SkeletonMapper@{SkeletonMapper}!LockAllTranslations@{LockAllTranslations}}
\index{LockAllTranslations@{LockAllTranslations}!SkeletonMapper@{SkeletonMapper}}
\doxysubsubsection{\texorpdfstring{LockAllTranslations()}{LockAllTranslations()}}
{\footnotesize\ttfamily void Skeleton\+Mapper\+::\+Lock\+All\+Translations (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classSkeleton}{Skeleton}} \texorpdfstring{$\ast$}{*}}]{in\+Skeleton2,  }\item[{const \mbox{\hyperlink{classMat44}{Mat44}} \texorpdfstring{$\ast$}{*}}]{in\+Neutral\+Pose2 }\end{DoxyParamCaption})}

After \doxylink{classSkeletonMapper_a63ce08263311941b64c074716b24c9bf}{Initialize()}, this can be called to lock the translation of all joints in skeleton 2 below the first mapped joint to those of the neutral pose. Because constraints are never 100\% rigid, there\textquotesingle{}s always a little bit of stretch in the ragdoll when the ragdoll is under stress. Locking the translations of the pose will remove the visual stretch from the ragdoll but will introduce a difference between the physical simulation and the visual representation. 
\begin{DoxyParams}{Parameters}
{\em in\+Skeleton2} & Target skeleton to map to. \\
\hline
{\em in\+Neutral\+Pose2} & Neutral pose to take reference translations from \\
\hline
\end{DoxyParams}
\Hypertarget{classSkeletonMapper_a2741193b04cb2cbe14996962fbf71b97}\label{classSkeletonMapper_a2741193b04cb2cbe14996962fbf71b97} 
\index{SkeletonMapper@{SkeletonMapper}!LockTranslations@{LockTranslations}}
\index{LockTranslations@{LockTranslations}!SkeletonMapper@{SkeletonMapper}}
\doxysubsubsection{\texorpdfstring{LockTranslations()}{LockTranslations()}}
{\footnotesize\ttfamily void Skeleton\+Mapper\+::\+Lock\+Translations (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classSkeleton}{Skeleton}} \texorpdfstring{$\ast$}{*}}]{in\+Skeleton2,  }\item[{const bool \texorpdfstring{$\ast$}{*}}]{in\+Locked\+Translations,  }\item[{const \mbox{\hyperlink{classMat44}{Mat44}} \texorpdfstring{$\ast$}{*}}]{in\+Neutral\+Pose2 }\end{DoxyParamCaption})}

This can be called so lock the translation of a specified set of joints in skeleton 2. Because constraints are never 100\% rigid, there\textquotesingle{}s always a little bit of stretch in the ragdoll when the ragdoll is under stress. Locking the translations of the pose will remove the visual stretch from the ragdoll but will introduce a difference between the physical simulation and the visual representation. 
\begin{DoxyParams}{Parameters}
{\em in\+Skeleton2} & Target skeleton to map to. \\
\hline
{\em in\+Locked\+Translations} & An array of bools the size of in\+Skeleton2-\/\texorpdfstring{$>$}{>}Get\+Joint\+Count(), for each joint indicating if the joint is locked. \\
\hline
{\em in\+Neutral\+Pose2} & Neutral pose to take reference translations from \\
\hline
\end{DoxyParams}
\Hypertarget{classSkeletonMapper_aa5ea82586d40fbdc0d2930e51b008c9c}\label{classSkeletonMapper_aa5ea82586d40fbdc0d2930e51b008c9c} 
\index{SkeletonMapper@{SkeletonMapper}!Map@{Map}}
\index{Map@{Map}!SkeletonMapper@{SkeletonMapper}}
\doxysubsubsection{\texorpdfstring{Map()}{Map()}}
{\footnotesize\ttfamily void Skeleton\+Mapper\+::\+Map (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classMat44}{Mat44}} \texorpdfstring{$\ast$}{*}}]{in\+Pose1\+Model\+Space,  }\item[{const \mbox{\hyperlink{classMat44}{Mat44}} \texorpdfstring{$\ast$}{*}}]{in\+Pose2\+Local\+Space,  }\item[{\mbox{\hyperlink{classMat44}{Mat44}} \texorpdfstring{$\ast$}{*}}]{out\+Pose2\+Model\+Space }\end{DoxyParamCaption}) const}

Map a pose. Joints that were directly mappable will be copied in model space from pose 1 to pose 2. Any joints that are only present in skeleton 2 will get their model space transform calculated through the local space transforms of pose 2. Joints that are part of a joint chain between two mapped joints will be reoriented towards the next joint in skeleton 1. This means that it is possible for unmapped joints to have some animation, but very extreme animation poses will show artifacts. 
\begin{DoxyParams}{Parameters}
{\em in\+Pose1\+Model\+Space} & Pose on skeleton 1 in model space \\
\hline
{\em in\+Pose2\+Local\+Space} & Pose on skeleton 2 in local space (used for the joints that cannot be mapped) \\
\hline
{\em out\+Pose2\+Model\+Space} & \doxylink{structModel}{Model} space pose on skeleton 2 (the output of the mapping) \\
\hline
\end{DoxyParams}
\Hypertarget{classSkeletonMapper_a64ebec9cb8e8f0f7a4ec68fa0c30bfd6}\label{classSkeletonMapper_a64ebec9cb8e8f0f7a4ec68fa0c30bfd6} 
\index{SkeletonMapper@{SkeletonMapper}!MapReverse@{MapReverse}}
\index{MapReverse@{MapReverse}!SkeletonMapper@{SkeletonMapper}}
\doxysubsubsection{\texorpdfstring{MapReverse()}{MapReverse()}}
{\footnotesize\ttfamily void Skeleton\+Mapper\+::\+Map\+Reverse (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classMat44}{Mat44}} \texorpdfstring{$\ast$}{*}}]{in\+Pose2\+Model\+Space,  }\item[{\mbox{\hyperlink{classMat44}{Mat44}} \texorpdfstring{$\ast$}{*}}]{out\+Pose1\+Model\+Space }\end{DoxyParamCaption}) const}

Reverse map a pose, this will only use the mappings and not the chains (it assumes that all joints in skeleton 1 are mapped) 
\begin{DoxyParams}{Parameters}
{\em in\+Pose2\+Model\+Space} & \doxylink{structModel}{Model} space pose on skeleton 2 \\
\hline
{\em out\+Pose1\+Model\+Space} & When the function returns this will contain the model space pose for skeleton 1 \\
\hline
\end{DoxyParams}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
includes/jolt/\+Skeleton/Skeleton\+Mapper.\+h\end{DoxyCompactItemize}
