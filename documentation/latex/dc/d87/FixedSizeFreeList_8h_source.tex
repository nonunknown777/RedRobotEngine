\doxysection{Fixed\+Size\+Free\+List.\+h}
\hypertarget{FixedSizeFreeList_8h_source}{}\label{FixedSizeFreeList_8h_source}\index{includes/jolt/Core/FixedSizeFreeList.h@{includes/jolt/Core/FixedSizeFreeList.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Jolt\ Physics\ Library\ (https://github.com/jrouwe/JoltPhysics)}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ SPDX-\/FileCopyrightText:\ 2021\ Jorrit\ Rouwe}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ SPDX-\/License-\/Identifier:\ MIT}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <Jolt/Core/NonCopyable.h>}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <Jolt/Core/Mutex.h>}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ <Jolt/Core/Atomics.h>}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ JPH\_NAMESPACE\_BEGIN}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00016\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Object>}
\DoxyCodeLine{00017\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classFixedSizeFreeList}{FixedSizeFreeList}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classNonCopyable}{NonCopyable}}}
\DoxyCodeLine{00018\ \{}
\DoxyCodeLine{00019\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00021\ \ \ \ \ \textcolor{keyword}{struct\ }ObjectStorage}
\DoxyCodeLine{00022\ \ \ \ \ \{}
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ Object\ \ \ \ \ \ \ \ \ \ \ \ \ \ mObject;}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ atomic<uint32>\ \ \ \ \ \ mNextFreeObject;}
\DoxyCodeLine{00029\ \ \ \ \ \};}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{keyword}{static\_assert}(\textcolor{keyword}{alignof}(ObjectStorage)\ ==\ \textcolor{keyword}{alignof}(Object),\ \textcolor{stringliteral}{"{}Object\ not\ properly\ aligned"{}});}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keyword}{const}\ ObjectStorage\ \&\ \ \ GetStorage(uint32\ inObjectIndex)\textcolor{keyword}{\ const\ \ }\{\ \textcolor{keywordflow}{return}\ mPages[inObjectIndex\ >>\ mPageShift][inObjectIndex\ \&\ mObjectMask];\ \}}
\DoxyCodeLine{00035\ \ \ \ \ ObjectStorage\ \&\ \ \ \ \ \ \ \ \ GetStorage(uint32\ inObjectIndex)\ \ \ \ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ mPages[inObjectIndex\ >>\ mPageShift][inObjectIndex\ \&\ mObjectMask];\ \}}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#ifdef\ JPH\_ENABLE\_ASSERTS}}
\DoxyCodeLine{00039\ \ \ \ \ atomic<uint32>\ \ \ \ \ \ \ \ \ \ mNumFreeObjects;}
\DoxyCodeLine{00040\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ JPH\_ENABLE\_ASSERTS}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00043\ \ \ \ \ atomic<uint32>\ \ \ \ \ \ \ \ \ \ mAllocationTag;}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00046\ \ \ \ \ atomic<uint64>\ \ \ \ \ \ \ \ \ \ mFirstFreeObjectAndTag;}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00049\ \ \ \ \ uint32\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mPageSize;}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00052\ \ \ \ \ uint32\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mPageShift;}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00055\ \ \ \ \ uint32\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mObjectMask;}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00058\ \ \ \ \ uint32\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mNumPages;}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00061\ \ \ \ \ uint32\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mNumObjectsAllocated;}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00064\ \ \ \ \ atomic<uint32>\ \ \ \ \ \ \ \ \ \ mFirstFreeObjectInNewPage;}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00067\ \ \ \ \ ObjectStorage\ **\ \ \ \ \ \ \ \ mPages\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00070\ \ \ \ \ Mutex\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mPageMutex;}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ uint32\ \ \ \ \ \mbox{\hyperlink{classFixedSizeFreeList_aa52c28cff499eeeb733b9b2f421a6f80}{cInvalidObjectIndex}}\ =\ 0xffffffff;}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00077\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \mbox{\hyperlink{classFixedSizeFreeList_a574046ef3a420bee3408d5a1930f0952}{ObjectStorageSize}}\ =\ \textcolor{keyword}{sizeof}(ObjectStorage);}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00080\ \ \ \ \ \textcolor{keyword}{inline}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classFixedSizeFreeList_a71571a26f9bc002d714f0178e46177ba}{\string~FixedSizeFreeList}}();}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classFixedSizeFreeList_a083084370fcf7fde019f6d4d8b99378e}{Init}}(uint\ inMaxObjects,\ uint\ inPageSize);}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}...\ Parameters>}
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{keyword}{inline}\ uint32\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classFixedSizeFreeList_a54bb676ae1632d32f3f07dea3e5b4ba8}{ConstructObject}}(Parameters\ \&\&...\ inParameters);}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classFixedSizeFreeList_a7446e6f32dac053462c14dfefcb467a0}{DestructObject}}(uint32\ inObjectIndex);}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classFixedSizeFreeList_a7446e6f32dac053462c14dfefcb467a0}{DestructObject}}(Object\ *inObject);}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structFixedSizeFreeList_1_1Batch}{Batch}}}
\DoxyCodeLine{00097\ \ \ \ \ \{}
\DoxyCodeLine{00098\ \ \ \ \ \ \ \ \ uint32\ \ \ \ \ \ \ \ \ \ \ \ \ \ mFirstObjectIndex\ =\ \mbox{\hyperlink{classFixedSizeFreeList_aa52c28cff499eeeb733b9b2f421a6f80}{cInvalidObjectIndex}};}
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ uint32\ \ \ \ \ \ \ \ \ \ \ \ \ \ mLastObjectIndex\ =\ \mbox{\hyperlink{classFixedSizeFreeList_aa52c28cff499eeeb733b9b2f421a6f80}{cInvalidObjectIndex}};}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ uint32\ \ \ \ \ \ \ \ \ \ \ \ \ \ mNumObjects\ =\ 0;}
\DoxyCodeLine{00101\ \ \ \ \ \};}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00106\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classFixedSizeFreeList_afed6e2529117da02be0ddbcc41a509a9}{AddObjectToBatch}}(\mbox{\hyperlink{structFixedSizeFreeList_1_1Batch}{Batch}}\ \&ioBatch,\ uint32\ inObjectIndex);}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classFixedSizeFreeList_a0bf25bd9e2c35e584e0bc14d40054bc2}{DestructObjectBatch}}(\mbox{\hyperlink{structFixedSizeFreeList_1_1Batch}{Batch}}\ \&ioBatch);}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00112\ \ \ \ \ \textcolor{keyword}{inline}\ Object\ \&\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classFixedSizeFreeList_accd9130a85781885d0d5f669ce0a86f1}{Get}}(uint32\ inObjectIndex)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{\ \textcolor{keywordflow}{return}\ GetStorage(inObjectIndex).mObject;\ \}}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00115\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{const}\ Object\ \&\ \ \ \mbox{\hyperlink{classFixedSizeFreeList_afcfce9ec76b8df6291beac70ab699080}{Get}}(uint32\ inObjectIndex)\textcolor{keyword}{\ const\ \ \ \ \ \ \ \ \ \ }\{\ \textcolor{keywordflow}{return}\ GetStorage(inObjectIndex).mObject;\ \}}
\DoxyCodeLine{00116\ \};}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ JPH\_NAMESPACE\_END}
\DoxyCodeLine{00119\ }
\DoxyCodeLine{00120\ \textcolor{preprocessor}{\#include\ "{}FixedSizeFreeList.inl"{}}}

\end{DoxyCode}
