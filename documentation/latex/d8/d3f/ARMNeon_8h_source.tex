\doxysection{ARMNeon.\+h}
\hypertarget{ARMNeon_8h_source}{}\label{ARMNeon_8h_source}\index{includes/jolt/Core/ARMNeon.h@{includes/jolt/Core/ARMNeon.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Jolt\ Physics\ Library\ (https://github.com/jrouwe/JoltPhysics)}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ SPDX-\/FileCopyrightText:\ 2022\ Jorrit\ Rouwe}}
\DoxyCodeLine{00003\ \textcolor{comment}{//\ SPDX-\/License-\/Identifier:\ MIT}}
\DoxyCodeLine{00004\ }
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#ifdef\ JPH\_USE\_NEON}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#ifdef\ JPH\_COMPILER\_MSVC}}
\DoxyCodeLine{00010\ \ \ \ \ JPH\_NAMESPACE\_BEGIN}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \ \ \ \ \textcolor{comment}{//\ Constructing\ NEON\ values}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\ \ \ \ \#define\ JPH\_NEON\_INT32x4(v1,\ v2,\ v3,\ v4)\ \{\ int64\_t(v1)\ +\ (int64\_t(v2)\ <<\ 32),\ int64\_t(v3)\ +\ (int64\_t(v4)\ <<\ 32)\ \}}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\ \ \ \ \#define\ JPH\_NEON\_UINT32x4(v1,\ v2,\ v3,\ v4)\ \{\ uint64\_t(v1)\ +\ (uint64\_t(v2)\ <<\ 32),\ uint64\_t(v3)\ +\ (uint64\_t(v4)\ <<\ 32)\ \}}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\ \ \ \ \#define\ JPH\_NEON\_INT8x16(v1,\ v2,\ v3,\ v4,\ v5,\ v6,\ v7,\ v8,\ v9,\ v10,\ v11,\ v12,\ v13,\ v14,\ v15,\ v16)\ \{\ int64\_t(v1)\ +\ (int64\_t(v2)\ <<\ 8)\ +\ (int64\_t(v3)\ <<\ 16)\ +\ (int64\_t(v4)\ <<\ 24)\ +\ (int64\_t(v5)\ <<\ 32)\ +\ (int64\_t(v6)\ <<\ 40)\ +\ (int64\_t(v7)\ <<\ 48)\ +\ (int64\_t(v8)\ <<\ 56),\ int64\_t(v9)\ +\ (int64\_t(v10)\ <<\ 8)\ +\ (int64\_t(v11)\ <<\ 16)\ +\ (int64\_t(v12)\ <<\ 24)\ +\ (int64\_t(v13)\ <<\ 32)\ +\ (int64\_t(v14)\ <<\ 40)\ +\ (int64\_t(v15)\ <<\ 48)\ +\ (int64\_t(v16)\ <<\ 56)\ \}}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \ \ \ \ \textcolor{comment}{//\ Generic\ shuffle\ vector\ template}}
\DoxyCodeLine{00018\ \ \ \ \ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{unsigned}\ I1,\ \textcolor{keywordtype}{unsigned}\ I2,\ \textcolor{keywordtype}{unsigned}\ I3,\ \textcolor{keywordtype}{unsigned}\ I4>}
\DoxyCodeLine{00019\ \ \ \ \ JPH\_INLINE\ float32x4\_t\ NeonShuffleFloat32x4(float32x4\_t\ inV1,\ float32x4\_t\ inV2)}
\DoxyCodeLine{00020\ \ \ \ \ \{}
\DoxyCodeLine{00021\ \ \ \ \ \ \ \ \ float32x4\_t\ ret;}
\DoxyCodeLine{00022\ \ \ \ \ \ \ \ \ ret\ =\ vmovq\_n\_f32(vgetq\_lane\_f32(I1\ >=\ 4?\ inV2\ :\ inV1,\ I1\ \&\ 0b11));}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ ret\ =\ vsetq\_lane\_f32(vgetq\_lane\_f32(I2\ >=\ 4?\ inV2\ :\ inV1,\ I2\ \&\ 0b11),\ ret,\ 1);}
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ ret\ =\ vsetq\_lane\_f32(vgetq\_lane\_f32(I3\ >=\ 4?\ inV2\ :\ inV1,\ I3\ \&\ 0b11),\ ret,\ 2);}
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ ret\ =\ vsetq\_lane\_f32(vgetq\_lane\_f32(I4\ >=\ 4?\ inV2\ :\ inV1,\ I4\ \&\ 0b11),\ ret,\ 3);}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ ret;}
\DoxyCodeLine{00027\ \ \ \ \ \}}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \ \ \ \ \textcolor{comment}{//\ Specializations}}
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{keyword}{template}\ <>}
\DoxyCodeLine{00031\ \ \ \ \ JPH\_INLINE\ float32x4\_t\ NeonShuffleFloat32x4<0,\ 1,\ 2,\ 2>(float32x4\_t\ inV1,\ float32x4\_t\ inV2)}
\DoxyCodeLine{00032\ \ \ \ \ \{}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ vcombine\_f32(vget\_low\_f32(inV1),\ vdup\_lane\_s32(vget\_high\_f32(inV1),\ 0));}
\DoxyCodeLine{00034\ \ \ \ \ \}}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keyword}{template}\ <>}
\DoxyCodeLine{00037\ \ \ \ \ JPH\_INLINE\ float32x4\_t\ NeonShuffleFloat32x4<0,\ 1,\ 3,\ 3>(float32x4\_t\ inV1,\ float32x4\_t\ inV2)}
\DoxyCodeLine{00038\ \ \ \ \ \{}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ vcombine\_f32(vget\_low\_f32(inV1),\ vdup\_lane\_s32(vget\_high\_f32(inV1),\ 1));}
\DoxyCodeLine{00040\ \ \ \ \ \}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keyword}{template}\ <>}
\DoxyCodeLine{00043\ \ \ \ \ JPH\_INLINE\ float32x4\_t\ NeonShuffleFloat32x4<0,\ 1,\ 2,\ 3>(float32x4\_t\ inV1,\ float32x4\_t\ inV2)}
\DoxyCodeLine{00044\ \ \ \ \ \{}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ inV1;}
\DoxyCodeLine{00046\ \ \ \ \ \}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keyword}{template}\ <>}
\DoxyCodeLine{00049\ \ \ \ \ JPH\_INLINE\ float32x4\_t\ NeonShuffleFloat32x4<1,\ 0,\ 3,\ 2>(float32x4\_t\ inV1,\ float32x4\_t\ inV2)}
\DoxyCodeLine{00050\ \ \ \ \ \{}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ vcombine\_f32(vrev64\_f32(vget\_low\_f32(inV1)),\ vrev64\_f32(vget\_high\_f32(inV1)));}
\DoxyCodeLine{00052\ \ \ \ \ \}}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \ \ \textcolor{keyword}{template}\ <>}
\DoxyCodeLine{00055\ \ \ \ \ JPH\_INLINE\ float32x4\_t\ NeonShuffleFloat32x4<2,\ 2,\ 1,\ 0>(float32x4\_t\ inV1,\ float32x4\_t\ inV2)}
\DoxyCodeLine{00056\ \ \ \ \ \{}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ vcombine\_f32(vdup\_lane\_s32(vget\_high\_f32(inV1),\ 0),\ vrev64\_f32(vget\_low\_f32(inV1)));}
\DoxyCodeLine{00058\ \ \ \ \ \}}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keyword}{template}\ <>}
\DoxyCodeLine{00061\ \ \ \ \ JPH\_INLINE\ float32x4\_t\ NeonShuffleFloat32x4<2,\ 3,\ 0,\ 1>(float32x4\_t\ inV1,\ float32x4\_t\ inV2)}
\DoxyCodeLine{00062\ \ \ \ \ \{}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ vcombine\_f32(vget\_high\_f32(inV1),\ vget\_low\_f32(inV1));}
\DoxyCodeLine{00064\ \ \ \ \ \}}
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{comment}{//\ Used\ extensively\ by\ cross\ product}}
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{keyword}{template}\ <>}
\DoxyCodeLine{00068\ \ \ \ \ JPH\_INLINE\ float32x4\_t\ NeonShuffleFloat32x4<1,\ 2,\ 0,\ 0>(float32x4\_t\ inV1,\ float32x4\_t\ inV2)}
\DoxyCodeLine{00069\ \ \ \ \ \{}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \textcolor{keyword}{static}\ int8x16\_t\ table\ =\ JPH\_NEON\_INT8x16(0x04,\ 0x05,\ 0x06,\ 0x07,\ 0x08,\ 0x09,\ 0x0a,\ 0x0b,\ 0x00,\ 0x01,\ 0x02,\ 0x03,\ 0x00,\ 0x01,\ 0x02,\ 0x03);}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ vreinterpretq\_f32\_u8(vqtbl1q\_u8(vreinterpretq\_u8\_f32(inV1),\ table));}
\DoxyCodeLine{00072\ \ \ \ \ \}}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{comment}{//\ Shuffle\ a\ vector}}
\DoxyCodeLine{00075\ \textcolor{preprocessor}{\ \ \ \ \#define\ JPH\_NEON\_SHUFFLE\_F32x4(vec1,\ vec2,\ index1,\ index2,\ index3,\ index4)\ NeonShuffleFloat32x4<index1,\ index2,\ index3,\ index4>(vec1,\ vec2)}}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ \ \ \ \ JPH\_NAMESPACE\_END}
\DoxyCodeLine{00078\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{comment}{//\ Constructing\ NEON\ values}}
\DoxyCodeLine{00080\ \textcolor{preprocessor}{\ \ \ \ \#define\ JPH\_NEON\_INT32x4(v1,\ v2,\ v3,\ v4)\ \{\ v1,\ v2,\ v3,\ v4\ \}}}
\DoxyCodeLine{00081\ \textcolor{preprocessor}{\ \ \ \ \#define\ JPH\_NEON\_UINT32x4(v1,\ v2,\ v3,\ v4)\ \{\ v1,\ v2,\ v3,\ v4\ \}}}
\DoxyCodeLine{00082\ \textcolor{preprocessor}{\ \ \ \ \#define\ JPH\_NEON\_INT8x16(v1,\ v2,\ v3,\ v4,\ v5,\ v6,\ v7,\ v8,\ v9,\ v10,\ v11,\ v12,\ v13,\ v14,\ v15,\ v16)\ \{\ v1,\ v2,\ v3,\ v4,\ v5,\ v6,\ v7,\ v8,\ v9,\ v10,\ v11,\ v12,\ v13,\ v14,\ v15,\ v16\ \}}}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \ \ \textcolor{comment}{//\ Shuffle\ a\ vector}}
\DoxyCodeLine{00085\ \textcolor{preprocessor}{\ \ \ \ \#define\ JPH\_NEON\_SHUFFLE\_F32x4(vec1,\ vec2,\ index1,\ index2,\ index3,\ index4)\ \_\_builtin\_shufflevector(vec1,\ vec2,\ index1,\ index2,\ index3,\ index4)}}
\DoxyCodeLine{00086\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ JPH\_USE\_NEON}}

\end{DoxyCode}
