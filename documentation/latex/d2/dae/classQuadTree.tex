\doxysection{Quad\+Tree Class Reference}
\hypertarget{classQuadTree}{}\label{classQuadTree}\index{QuadTree@{QuadTree}}


{\ttfamily \#include $<$Quad\+Tree.\+h$>$}



Inheritance diagram for Quad\+Tree\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=196pt]{df/d2f/classQuadTree__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for Quad\+Tree\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=196pt]{d8/db1/classQuadTree__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structQuadTree_1_1AddState}{Add\+State}}
\begin{DoxyCompactList}\small\item\em Temporary data structure to pass information between Add\+Bodies\+Prepare and Add\+Bodies\+Finalize/\+Abort. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structQuadTree_1_1Tracking}{Tracking}}
\begin{DoxyCompactList}\small\item\em Data to track location of a \doxylink{classBody}{Body} in the tree. \end{DoxyCompactList}\item 
struct \mbox{\hyperlink{structQuadTree_1_1UpdateState}{Update\+State}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{classQuadTree_aec53c63c36f1185bd75623cbc27830d6}\label{classQuadTree_aec53c63c36f1185bd75623cbc27830d6} 
using {\bfseries Allocator} = \mbox{\hyperlink{classFixedSizeFreeList}{Fixed\+Size\+Free\+List}}$<$ \mbox{\hyperlink{classNode}{Node}} $>$
\begin{DoxyCompactList}\small\item\em Class that allocates tree nodes, can be shared between multiple trees. \end{DoxyCompactList}\item 
\Hypertarget{classQuadTree_ad70bd0403f84927b007159eeaebf85c1}\label{classQuadTree_ad70bd0403f84927b007159eeaebf85c1} 
using {\bfseries Tracking\+Vector} = Array$<$ \mbox{\hyperlink{structQuadTree_1_1Tracking}{Tracking}} $>$
\end{DoxyCompactItemize}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{classQuadTree_a236dde2058a3ccf2babbe4a289327b30}\label{classQuadTree_a236dde2058a3ccf2babbe4a289327b30} 
{\bfseries \texorpdfstring{$\sim$}{\string~}\+Quad\+Tree} ()
\begin{DoxyCompactList}\small\item\em Destructor. \end{DoxyCompactList}\item 
\Hypertarget{classQuadTree_a0f40b5da772779a14a6d6aedd28ae8a0}\label{classQuadTree_a0f40b5da772779a14a6d6aedd28ae8a0} 
bool {\bfseries Has\+Bodies} () const
\begin{DoxyCompactList}\small\item\em Check if there is anything in the tree. \end{DoxyCompactList}\item 
\Hypertarget{classQuadTree_a92ac4f8879ce137be588d0c9f1d0582c}\label{classQuadTree_a92ac4f8879ce137be588d0c9f1d0582c} 
bool {\bfseries Is\+Dirty} () const
\begin{DoxyCompactList}\small\item\em Check if the tree needs an Update\+Prepare/\+Finalize() \end{DoxyCompactList}\item 
\Hypertarget{classQuadTree_aa88f08218784b62ffdf8596c74f690d6}\label{classQuadTree_aa88f08218784b62ffdf8596c74f690d6} 
bool {\bfseries Can\+Be\+Updated} () const
\begin{DoxyCompactList}\small\item\em Check if this tree can get an Update\+Prepare/\+Finalize() or if it needs a \doxylink{classQuadTree_a6e7b9e3242b2af8c7ba11d9b6eeb0d64}{Discard\+Old\+Tree()} first. \end{DoxyCompactList}\item 
\Hypertarget{classQuadTree_a61023e566be172a288dfcd728118ec46}\label{classQuadTree_a61023e566be172a288dfcd728118ec46} 
void {\bfseries Init} (\mbox{\hyperlink{classQuadTree_aec53c63c36f1185bd75623cbc27830d6}{Allocator}} \&in\+Allocator)
\begin{DoxyCompactList}\small\item\em Initialization. \end{DoxyCompactList}\item 
\Hypertarget{classQuadTree_a6e7b9e3242b2af8c7ba11d9b6eeb0d64}\label{classQuadTree_a6e7b9e3242b2af8c7ba11d9b6eeb0d64} 
void {\bfseries Discard\+Old\+Tree} ()
\begin{DoxyCompactList}\small\item\em Will throw away the previous frame\textquotesingle{}s nodes so that we can start building a new tree in the background. \end{DoxyCompactList}\item 
\Hypertarget{classQuadTree_a809502262f3bd9d11318763758ae6e7e}\label{classQuadTree_a809502262f3bd9d11318763758ae6e7e} 
\mbox{\hyperlink{classAABox}{AABox}} {\bfseries Get\+Bounds} () const
\begin{DoxyCompactList}\small\item\em Get the bounding box for this tree. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classQuadTree_ad819632f6a3b9912462c731eb017cd4f}{Update\+Prepare}} (const Body\+Vector \&in\+Bodies, Tracking\+Vector \&io\+Tracking, \mbox{\hyperlink{structQuadTree_1_1UpdateState}{Update\+State}} \&out\+Update\+State, bool in\+Full\+Rebuild)
\item 
\Hypertarget{classQuadTree_a95788f7c5352a8b053be1ac426d5536d}\label{classQuadTree_a95788f7c5352a8b053be1ac426d5536d} 
void {\bfseries Update\+Finalize} (const Body\+Vector \&in\+Bodies, const Tracking\+Vector \&in\+Tracking, const \mbox{\hyperlink{structQuadTree_1_1UpdateState}{Update\+State}} \&in\+Update\+State)
\item 
void \mbox{\hyperlink{classQuadTree_a79ce6a7e423da6a09ff4be8e7f6d453c}{Add\+Bodies\+Prepare}} (const Body\+Vector \&in\+Bodies, Tracking\+Vector \&io\+Tracking, \mbox{\hyperlink{classBodyID}{Body\+ID}} \texorpdfstring{$\ast$}{*}io\+Body\+IDs, int in\+Number, \mbox{\hyperlink{structQuadTree_1_1AddState}{Add\+State}} \&out\+State)
\item 
\Hypertarget{classQuadTree_aaf165671ff225afec0336dca906f9219}\label{classQuadTree_aaf165671ff225afec0336dca906f9219} 
void {\bfseries Add\+Bodies\+Finalize} (Tracking\+Vector \&io\+Tracking, int in\+Number\+Bodies, const \mbox{\hyperlink{structQuadTree_1_1AddState}{Add\+State}} \&in\+State)
\begin{DoxyCompactList}\small\item\em Finalize adding bodies to the quadtree, supply the same number of bodies as in Add\+Bodies\+Prepare. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{classQuadTree_a3f04fc0ab8ec76c39e7e4ac4679e6ffa}{Add\+Bodies\+Abort}} (Tracking\+Vector \&io\+Tracking, const \mbox{\hyperlink{structQuadTree_1_1AddState}{Add\+State}} \&in\+State)
\item 
\Hypertarget{classQuadTree_ae87cda722c454860d1566a6c5f4b11dc}\label{classQuadTree_ae87cda722c454860d1566a6c5f4b11dc} 
void {\bfseries Remove\+Bodies} (const Body\+Vector \&in\+Bodies, Tracking\+Vector \&io\+Tracking, const \mbox{\hyperlink{classBodyID}{Body\+ID}} \texorpdfstring{$\ast$}{*}io\+Body\+IDs, int in\+Number)
\begin{DoxyCompactList}\small\item\em Remove in\+Number bodies in io\+Body\+IDs from the quadtree. \end{DoxyCompactList}\item 
\Hypertarget{classQuadTree_a903406946b47220890c1a2091a5c38ad}\label{classQuadTree_a903406946b47220890c1a2091a5c38ad} 
void {\bfseries Notify\+Bodies\+AABBChanged} (const Body\+Vector \&in\+Bodies, const Tracking\+Vector \&in\+Tracking, const \mbox{\hyperlink{classBodyID}{Body\+ID}} \texorpdfstring{$\ast$}{*}io\+Body\+IDs, int in\+Number)
\begin{DoxyCompactList}\small\item\em Call whenever the aabb of a body changes. \end{DoxyCompactList}\item 
\Hypertarget{classQuadTree_a0f4c8a4eaa9c665153582c4a1e974457}\label{classQuadTree_a0f4c8a4eaa9c665153582c4a1e974457} 
void {\bfseries Cast\+Ray} (const \mbox{\hyperlink{structRayCast}{Ray\+Cast}} \&in\+Ray, \mbox{\hyperlink{classCollisionCollector}{Ray\+Cast\+Body\+Collector}} \&io\+Collector, const \mbox{\hyperlink{classObjectLayerFilter}{Object\+Layer\+Filter}} \&in\+Object\+Layer\+Filter, const Tracking\+Vector \&in\+Tracking) const
\begin{DoxyCompactList}\small\item\em Cast a ray and get the intersecting bodies in io\+Collector. \end{DoxyCompactList}\item 
\Hypertarget{classQuadTree_a894acaffc70d6ef992626359b3c65284}\label{classQuadTree_a894acaffc70d6ef992626359b3c65284} 
void {\bfseries Collide\+AABox} (const \mbox{\hyperlink{classAABox}{AABox}} \&in\+Box, \mbox{\hyperlink{classCollisionCollector}{Collide\+Shape\+Body\+Collector}} \&io\+Collector, const \mbox{\hyperlink{classObjectLayerFilter}{Object\+Layer\+Filter}} \&in\+Object\+Layer\+Filter, const Tracking\+Vector \&in\+Tracking) const
\begin{DoxyCompactList}\small\item\em Get bodies intersecting with in\+Box in io\+Collector. \end{DoxyCompactList}\item 
\Hypertarget{classQuadTree_ab83e557e1224ba241789ce7d7da982de}\label{classQuadTree_ab83e557e1224ba241789ce7d7da982de} 
void {\bfseries Collide\+Sphere} (\mbox{\hyperlink{classVec3}{Vec3\+Arg}} in\+Center, float in\+Radius, \mbox{\hyperlink{classCollisionCollector}{Collide\+Shape\+Body\+Collector}} \&io\+Collector, const \mbox{\hyperlink{classObjectLayerFilter}{Object\+Layer\+Filter}} \&in\+Object\+Layer\+Filter, const Tracking\+Vector \&in\+Tracking) const
\begin{DoxyCompactList}\small\item\em Get bodies intersecting with a sphere in io\+Collector. \end{DoxyCompactList}\item 
\Hypertarget{classQuadTree_ab5538217d4a9a42986da28d64b65740d}\label{classQuadTree_ab5538217d4a9a42986da28d64b65740d} 
void {\bfseries Collide\+Point} (\mbox{\hyperlink{classVec3}{Vec3\+Arg}} in\+Point, \mbox{\hyperlink{classCollisionCollector}{Collide\+Shape\+Body\+Collector}} \&io\+Collector, const \mbox{\hyperlink{classObjectLayerFilter}{Object\+Layer\+Filter}} \&in\+Object\+Layer\+Filter, const Tracking\+Vector \&in\+Tracking) const
\begin{DoxyCompactList}\small\item\em Get bodies intersecting with a point and any hits to io\+Collector. \end{DoxyCompactList}\item 
\Hypertarget{classQuadTree_a3bcf63c8fc180d29f75794e979399756}\label{classQuadTree_a3bcf63c8fc180d29f75794e979399756} 
void {\bfseries Collide\+Oriented\+Box} (const \mbox{\hyperlink{classOrientedBox}{Oriented\+Box}} \&in\+Box, \mbox{\hyperlink{classCollisionCollector}{Collide\+Shape\+Body\+Collector}} \&io\+Collector, const \mbox{\hyperlink{classObjectLayerFilter}{Object\+Layer\+Filter}} \&in\+Object\+Layer\+Filter, const Tracking\+Vector \&in\+Tracking) const
\begin{DoxyCompactList}\small\item\em Get bodies intersecting with an oriented box and any hits to io\+Collector. \end{DoxyCompactList}\item 
\Hypertarget{classQuadTree_aa28951f663c136f9b3faee823393cc1b}\label{classQuadTree_aa28951f663c136f9b3faee823393cc1b} 
void {\bfseries Cast\+AABox} (const \mbox{\hyperlink{structAABoxCast}{AABox\+Cast}} \&in\+Box, \mbox{\hyperlink{classCollisionCollector}{Cast\+Shape\+Body\+Collector}} \&io\+Collector, const \mbox{\hyperlink{classObjectLayerFilter}{Object\+Layer\+Filter}} \&in\+Object\+Layer\+Filter, const Tracking\+Vector \&in\+Tracking) const
\begin{DoxyCompactList}\small\item\em Cast a box and get intersecting bodies in io\+Collector. \end{DoxyCompactList}\item 
\Hypertarget{classQuadTree_a1752afb7a82b6ca130cfbad4f4f02c4e}\label{classQuadTree_a1752afb7a82b6ca130cfbad4f4f02c4e} 
void {\bfseries Find\+Colliding\+Pairs} (const Body\+Vector \&in\+Bodies, const \mbox{\hyperlink{classBodyID}{Body\+ID}} \texorpdfstring{$\ast$}{*}in\+Active\+Bodies, int in\+Num\+Active\+Bodies, float in\+Speculative\+Contact\+Distance, \mbox{\hyperlink{classCollisionCollector}{Body\+Pair\+Collector}} \&io\+Pair\+Collector, const \mbox{\hyperlink{classObjectLayerPairFilter}{Object\+Layer\+Pair\+Filter}} \&in\+Object\+Layer\+Pair\+Filter) const
\begin{DoxyCompactList}\small\item\em Find all colliding pairs between dynamic bodies, calls io\+Pair\+Collector for every pair found. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classNonCopyable}{Non\+Copyable}}}
\begin{DoxyCompactItemize}
\item 
{\bfseries Non\+Copyable} (const \mbox{\hyperlink{classNonCopyable}{Non\+Copyable}} \&)=delete
\item 
void {\bfseries operator=} (const \mbox{\hyperlink{classNonCopyable}{Non\+Copyable}} \&)=delete
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Internal tree structure in broadphase, is essentially a quad AABB tree. Tree is lockless (except for Update\+Prepare/\+Finalize() function), modifying objects in the tree will widen the aabbs of parent nodes to make the node fit. During the Update\+Prepare/\+Finalize() call the tree is rebuilt to achieve a tight fit again. 

\doxysubsection{Member Function Documentation}
\Hypertarget{classQuadTree_a3f04fc0ab8ec76c39e7e4ac4679e6ffa}\label{classQuadTree_a3f04fc0ab8ec76c39e7e4ac4679e6ffa} 
\index{QuadTree@{QuadTree}!AddBodiesAbort@{AddBodiesAbort}}
\index{AddBodiesAbort@{AddBodiesAbort}!QuadTree@{QuadTree}}
\doxysubsubsection{\texorpdfstring{AddBodiesAbort()}{AddBodiesAbort()}}
{\footnotesize\ttfamily void Quad\+Tree\+::\+Add\+Bodies\+Abort (\begin{DoxyParamCaption}\item[{Tracking\+Vector \&}]{io\+Tracking,  }\item[{const \mbox{\hyperlink{structQuadTree_1_1AddState}{Add\+State}} \&}]{in\+State }\end{DoxyParamCaption})}

Abort adding bodies to the quadtree, supply the same bodies and state as in Add\+Bodies\+Prepare. This can be done on a background thread without influencing the broadphase. \Hypertarget{classQuadTree_a79ce6a7e423da6a09ff4be8e7f6d453c}\label{classQuadTree_a79ce6a7e423da6a09ff4be8e7f6d453c} 
\index{QuadTree@{QuadTree}!AddBodiesPrepare@{AddBodiesPrepare}}
\index{AddBodiesPrepare@{AddBodiesPrepare}!QuadTree@{QuadTree}}
\doxysubsubsection{\texorpdfstring{AddBodiesPrepare()}{AddBodiesPrepare()}}
{\footnotesize\ttfamily void Quad\+Tree\+::\+Add\+Bodies\+Prepare (\begin{DoxyParamCaption}\item[{const Body\+Vector \&}]{in\+Bodies,  }\item[{Tracking\+Vector \&}]{io\+Tracking,  }\item[{\mbox{\hyperlink{classBodyID}{Body\+ID}} \texorpdfstring{$\ast$}{*}}]{io\+Body\+IDs,  }\item[{int}]{in\+Number,  }\item[{\mbox{\hyperlink{structQuadTree_1_1AddState}{Add\+State}} \&}]{out\+State }\end{DoxyParamCaption})}

Prepare adding in\+Number bodies at io\+Body\+IDs to the quad tree, returns the state in out\+State that should be used in Add\+Bodies\+Finalize. This can be done on a background thread without influencing the broadphase. io\+Body\+IDs may be shuffled around by this function. \Hypertarget{classQuadTree_ad819632f6a3b9912462c731eb017cd4f}\label{classQuadTree_ad819632f6a3b9912462c731eb017cd4f} 
\index{QuadTree@{QuadTree}!UpdatePrepare@{UpdatePrepare}}
\index{UpdatePrepare@{UpdatePrepare}!QuadTree@{QuadTree}}
\doxysubsubsection{\texorpdfstring{UpdatePrepare()}{UpdatePrepare()}}
{\footnotesize\ttfamily void Quad\+Tree\+::\+Update\+Prepare (\begin{DoxyParamCaption}\item[{const Body\+Vector \&}]{in\+Bodies,  }\item[{Tracking\+Vector \&}]{io\+Tracking,  }\item[{\mbox{\hyperlink{structQuadTree_1_1UpdateState}{Update\+State}} \&}]{out\+Update\+State,  }\item[{bool}]{in\+Full\+Rebuild }\end{DoxyParamCaption})}

Update the broadphase, needs to be called regularly to achieve a tight fit of the tree when bodies have been modified. \doxylink{classQuadTree_ad819632f6a3b9912462c731eb017cd4f}{Update\+Prepare()} will build the tree, Update\+Finalize() will lock the root of the tree shortly and swap the trees and afterwards clean up temporary data structures. 

The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
includes/jolt/\+Physics/\+Collision/\+Broad\+Phase/Quad\+Tree.\+h\end{DoxyCompactItemize}
